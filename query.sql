-- 1. Đưa ra đội bóng có cầu thủ ghi bàn nhiều nhất,cầu thủ ghi bàn nhiều nhất và số bàn thắng của anh ta.
select concat(Players.LastName, ' ', Players.FirstName) Name, EplTable.Name Club, Players.Goals from EplTable, Players where(EplTable.ShortName = Players.ShortName and Players.Goals = (select max(Goals) from Players));

-- 2. Đưa ra đội bóng có nhiều cầu thủ ghi bàn nhất và số lượng cầu thủ ghi bàn.
select EplTable.Name, count(concat(Players.LastName, ' ', Players.FirstName)) 'Player' from EplTable, Players where(EplTable.ShortName = Players.ShortName and Players.Goals > 0) group by Players.ShortName order by count(concat(Players.LastName, ' ', Players.FirstName)) desc limit 1;

-- 3. Thống kê số lượng thẻ vàng và thẻ đỏ của các đội bóng.
select EplTable.Name, sum(Players.YellowCard) YC, sum(Players.RedCard) RC from EplTable, Players where(EplTable.ShortName = Players.ShortName) group by Players.ShortName;

-- 4. Đưa ra đội bóng có nhiều thẻ vàng nhất và đội bóng có nhiều thẻ đỏ nhất.

select (@name := (select EplTable.Name from EplTable, Players where(EplTable.ShortName = Players.ShortName) group by Players.ShortName order by sum(Players.YellowCard) desc limit 1)) Team, (@YC := (select sum(YellowCard) from Players group by ShortName order by sum(YellowCard) desc limit 1)) YC, (@name := (select EplTable.Name from EplTable, Players where(EplTable.ShortName = Players.ShortName) group by Players.ShortName order by sum(Players.RedCard) desc limit 1)) Team, (@YC := (select sum(RedCard) from Players group by ShortName order by sum(RedCard) desc limit 1)) RC;

-- 5. Đưa ra 3 đội bóng có điểm cao nhất và 3 đội bóng có điểm thấp nhất.

(select * from EplTable order by Point desc limit 3) union (select '...', '...', '...','...', '...', '...', '...', '...', '...') union (select * from EplTable order by Point desc limit 17,3);

-- 6. Đưa ra đội bóng ghi nhiều bàn thắng trên sân nhà nhất, nhiều bán thắng trên sân khách nhất, ít bàn thắng trên sân nhà nhất, ít bàn thắng trên sân khách nhất

(select (@a := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) desc limit 1)) Home, (@b := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) desc limit 1)) Goals, (@c := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) desc limit 1)) Away, (@d := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) desc limit 1)) Goals) union (select '...', '...', '...', '...') union (select (@e := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) asc limit 1)) Home, (@f := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) asc limit 1)) Goals, (@g := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) asc limit 1)) Away, (@h := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) asc limit 1)) Goals);

-- 7. Đưa ra 3 đội bóng ghi nhiều bàn thắng trên sân nhà nhất, nhiều bán thắng trên sân khách nhất, ít bàn thắng trên sân nhà nhất, ít bàn thắng trên sân khách nhất

(select (@a1 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) desc limit 1)) Home, (@b1 := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) desc limit 1)) Goals, (@c1 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) desc limit 1)) Away, (@d1 := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) desc limit 1)) Goals) union (select (@a2 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) desc limit 1,1)) Home, (@b2 := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) desc limit 1,1)) Goals, (@c2 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) desc limit 1,1)) Away, (@d2 := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) desc limit 1,1)) Goals) union (select (@a3 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) desc limit 2,1)) Home, (@b3 := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) desc limit 2,1)) Goals, (@c3 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) desc limit 2,1)) Away, (@d3 := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) desc limit 2,1)) Goals) union (select '...', '...', '...', '...') union (select (@a18 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) asc limit 2,1)) Home, (@b18 := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) asc limit 2,1)) Goals, (@c18 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) asc limit 2,1)) Away, (@d18 := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) asc limit 2,1)) Goals) union (select (@a19 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) asc limit 1,1)) Home, (@b19 := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) asc limit 1,1)) Goals, (@c19 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) asc limit 1,1)) Away, (@d19 := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) asc limit 1,1)) Goals) union (select (@a20 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.HomeScore) asc limit 1)) Home, (@b20 := (select sum(HomeScore) from Result group by Home order by sum(Result.HomeScore) asc limit 1)) Goals, (@c20 := (select EplTable.Name from EplTable, Result where (EplTable.ShortName = Result.Home) group by Result.Home order by sum(Result.Away) asc limit 1)) Away, (@d20 := (select sum(AwayScore) from Result group by Away order by sum(Result.AwayScore) asc limit 1)) Goals);

-- 8. Đưa ra bảng xếp hạng giải Ngoại Hạng Anh

set @a=0;select (@a := @a+1) Rank, case when @a <= 4 then "UCL" when @a = 5 then "UEL" when @a >= 18 then "EFL" else "" end as Status, Name, Win + Draw + Lose Round, Win W, Draw D, Lose L, GoalsFor GF, GoalsAgainst GA, GoalDifferent GD, Point P from EplTable order by Point desc, GoalDifferent desc, GoalsFor desc;

-- 9. Đưa ra tên đội bóng có tỉ lệ người truy cập trang web là Nam nhiều nhất.

select EplTable.Name, GuestInfo.Male from EplTable, ClubInfo, GuestInfo where (EplTable.ShortName = ClubInfo.ShortName and ClubInfo.Website = GuestInfo.Website) order by GuestInfo.Male desc limit 1;

-- 10. Đưa ra tên huấn luyện viên của đội bóng có nhiều hơn 8 trận thua.

select EplTable.Name, ClubInfo.HeadCoach, EplTable.Lose from EplTable, ClubInfo where (EplTable.ShortName = ClubInfo.ShortName and EplTable.Lose > 8) order by EplTable.Lose desc;

-- 11. Đưa ra tên huấn luyện viên của đội bóng thắng trên sân nhà nhiều nhất, ít nhất, thắng trên sân khách nhiều nhất, ít nhất, thua trên sân nhà nhiều nhất, ít nhất, thua trên sân khách nhiều nhất, ít nhất.

(select (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Away Match Lose') union(select '...', '...', '...', '...', '...', '...', '...', '...', '...', '...', '...', '...') union (select(@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Away Match Lose');

-- 12. Đưa ra tên ba huấn luyện viên của ba đội bóng thắng trên sân nhà nhiều nhất, ít nhất, thắng trên sân khách nhiều nhất, ít nhất, thua trên sân nhà nhiều nhất, ít nhất, thua trên sân khách nhiều nhất, ít nhất.

(select (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1)) 'Away Match Lose') union (select (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1,1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 1,1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1,1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 1,1)) 'Away Match Lose') union (select (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 2,1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) desc limit 2,1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 2,1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) desc limit 2,1)) 'Away Match Lose') union (select '...', '...', '...', '...', '...', '...', '...', '...', '...', '...', '...', '...') union (select(@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 2,1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 2,1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 2,1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 2,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 2,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 2,1)) 'Away Match Lose') union (select(@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1,1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1,1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1,1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1,1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1,1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1,1)) 'Away Match Lose') union (select(@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore > Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Home Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Home and Result.HomeScore < Result.AwayScore) group by Result.Home order by count(Result.Home) asc limit 1)) 'Home Match Lose', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore < Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Away Match Win', (@a := (select ClubInfo.HeadCoach from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'HeadCoach', (@b := (select EplTable.Name from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Name', (@c := (select count(Result.Home) 'Match Win' from ClubInfo, EplTable, Result where(ClubInfo.ShortName = EplTable.ShortName and EplTable.ShortName = Result.Away and Result.HomeScore > Result.AwayScore) group by Result.Away order by count(Result.Home) asc limit 1)) 'Away Match Lose');

-- 13. Liệt kê những trận hòa không có bàn thắng.

select Result.Round, concat(a.Name, ' ', Result.HomeScore, '-', Result.AwayScore, ' ', b.Name) 'Match', ClubInfo.StadiumName, StadiumInfo.Seats from EplTable as a, EplTable as b, Result, ClubInfo, StadiumInfo where(a.ShortName = Result.Home and b.ShortName = Result.Away and a.ShortName = ClubInfo.ShortName and ClubInfo.StadiumName = StadiumInfo.StadiumName and Result.HomeScore + Result.AwayScore = 0) order by Result.Round;

-- 14. Đưa ra trận đấu có nhiều bàn thắng nhất.

select Result.Round, concat(a.Name, ' ', Result.HomeScore, '-', Result.AwayScore, ' ', b.Name) 'Match', ClubInfo.StadiumName, StadiumInfo.Seats from EplTable as a, EplTable as b, Result, ClubInfo, StadiumInfo where(a.ShortName = Result.Home and b.ShortName = Result.Away and a.ShortName = ClubInfo.ShortName and ClubInfo.StadiumName = StadiumInfo.StadiumName and Result.HomeScore + Result.AwayScore = (select max(HomeScore + AwayScore) from Result)) order by Result.Round;

-- 15. Đưa ra khoảng cách lớn nhất giữa hai đội bóng và khoảng cách nhỏ nhất giữa 2 đội bóng.

set @rad=3.14159/180;(select a.Name, b.Name,round(acos(sin(c.Latitude * @rad) * sin(d.Latitude * @rad) + cos(c.Latitude * @rad) * cos(d.Latitude * @rad) * cos((c.Longitude - d.Longitude) * @rad)) * 6371, 2) Distance from EplTable as a, EplTable as b, StadiumInfo as c, StadiumInfo as d, ClubInfo as e, ClubInfo as f where(a.ShortName = e.ShortName and e.StadiumName = c.StadiumName and b.ShortName = f.ShortName and f.StadiumName = d.StadiumName and a.ShortName != b.ShortName) order by acos(sin(c.Latitude * @rad) * sin(d.Latitude * @rad) + cos(c.Latitude * @rad) * cos(d.Latitude * @rad) * cos((c.Longitude - d.Longitude) * @rad)) * 6371 desc limit 1) union (select '...', '...', '...') union (select a.Name, b.Name,round(acos(sin(c.Latitude * @rad) * sin(d.Latitude * @rad) + cos(c.Latitude * @rad) * cos(d.Latitude * @rad) * cos((c.Longitude - d.Longitude) * @rad)) * 6371, 2) Distance from EplTable as a, EplTable as b, StadiumInfo as c, StadiumInfo as d, ClubInfo as e, ClubInfo as f where(a.ShortName = e.ShortName and e.StadiumName = c.StadiumName and b.ShortName = f.ShortName and f.StadiumName = d.StadiumName and a.ShortName != b.ShortName) order by acos(sin(c.Latitude * @rad) * sin(d.Latitude * @rad) + cos(c.Latitude * @rad) * cos(d.Latitude * @rad) * cos((c.Longitude - d.Longitude) * @rad)) * 6371 asc limit 1);

-- 16. Đưa ra tổng thời gian truy cập website theo tháng của mỗi đội bóng.

select EplTable.Name, concat(floor(floor((floor((floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) /60) + hour(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) / 24) / 7), ' week(s) ', (floor((floor((floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) /60) + hour(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) / 24) % 7), ' day(s) ' ,(floor((floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) /60) + hour(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) % 24, ' hour(s) ', (floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) % 60, ' minute(s) ', (second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) % 60, ' second(s)') 'Total Time Access' from EplTable, ClubInfo, WebsiteInfo where(EplTable.ShortName = ClubInfo.ShortName and ClubInfo.Website = WebsiteInfo.Website) order by floor(floor((floor((floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) /60) + hour(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) / 24) / 7) desc, (floor((floor((floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) /60) + hour(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) / 24) % 7) desc, (floor((floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) /60) + hour(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) % 24 desc, (floor(second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits / 60) + minute(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) % 60 desc, (second(WebsiteInfo.TimeAccessAverage) * MonthlyVisits) % 60 desc;

-- 17. Đưa ra độ tuổi phổ biến (>20%), giới tính phổ biến (>50%), thiết bị truy cập phổ biến (>50%) của người truy cập trang web của mỗi đội bóng.

select EplTable.Name, case when GuestInfo.18to24 > 20 then "x" else "" end as '18-24', case when GuestInfo.25to34 > 20 then "x" else "" end as '25-34', case when GuestInfo.35to44 > 20 then "x" else "" end as '35-44', case when GuestInfo.45to54 > 20 then "x" else "" end as '45-54', case when GuestInfo.55to64 > 20 then "x" else "" end as '55-64', case when GuestInfo.65plus > 20 then "x" else "" end as '65+', case when GuestInfo.Male >= 50 then "x" else "" end as 'Male', case when GuestInfo.Female >= 50 then "x" else "" end as 'Female', case when GuestInfo.Desktop >= 50 then "x" else "" end as 'Desktop', case when GuestInfo.Mobile >= 50 then "x" else "" end as 'Mobile' from EplTable, ClubInfo, GuestInfo where(EplTable.ShortName = ClubInfo.ShortName and ClubInfo.Website = GuestInfo.Website);

-- 18. Đưa ra số quảng cáo được người dùng desktop bấm vào của mỗi đội bóng.

select EplTable.Name, round(WebsiteInfo.MonthlyVisits * GuestInfo.Desktop * GuestInfo.Advertise / 10000) as 'Advertise' from EplTable, WebsiteInfo, ClubInfo, GuestInfo where(EplTable.ShortName = ClubInfo.ShortName and ClubInfo.Website = WebsiteInfo.Website and ClubInfo.Website = GuestInfo.Website) order by WebsiteInfo.MonthlyVisits * GuestInfo.Desktop * GuestInfo.Advertise / 10000 desc;

-- 19. Đưa ra 10 cầu thủ có tần suất ghi bàn cao nhất.

select EplTable.Name 'Team Name', concat(Players.LastName, ' ', Players.FirstName) 'Player Name', round(Players.Minutes / Players.Goals, 2) 'Min/Goals' from EplTable, Players where(EplTable.ShortName = Players.ShortName and Players.Goals > 0 and Players.Minutes > 0) order by Players.Minutes / Players.Goals asc limit 10;

-- 20. Đưa ra kết quả các trận đấu ở vòng 13.

select concat(a.Name, ' ', Result.HomeScore, '-', Result.AwayScore, ' ', b.Name) 'Match', ClubInfo.StadiumName, StadiumInfo.Seats from EplTable as a, EplTable as b, Result, ClubInfo, StadiumInfo where(a.ShortName = Result.Home and b.ShortName = Result.Away and a.ShortName = ClubInfo.ShortName and ClubInfo.StadiumName = StadiumInfo.StadiumName and Result.Round = 13);

-- 21. Giả sử có trận đấu Arsenal 3-1 Bournemouth, tạo bảng EplTable2 giống bảng EplTable và cập nhật bảng xếp hạng.

create table EplTable2 as select * from EplTable;alter table EplTable2 add column (PreviousRank integer, CurrentRank integer);set @a=0;update EplTable2 set PreviousRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;update EplTable2 set Win = Win + 1, Draw = Draw + 0, Lose = Lose + 0, GoalsFor = GoalsFor + 3, GoalsAgainst = GoalsAgainst + 1, GoalDifferent = GoalsFor - GoalsAgainst, Point = Point + 3 where Name = 'Arsenal';update EplTable2 set Win = Win + 0, Draw = Draw + 0, Lose = Lose + 1, GoalsFor = GoalsFor + 1, GoalsAgainst = GoalsAgainst + 3, GoalDifferent = GoalsFor - GoalsAgainst, Point = Point + 0 where Name = 'Bournemouth';set @a = 0;update EplTable2 set CurrentRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;set @a=0;select case when PreviousRank = CurrentRank then concat((@a := @a+1), ' ', '-') when PreviousRank > CurrentRank then concat((@a := @a+1), ' ', '^') else concat((@a := @a+1), ' ', 'v') end as 'Rank', case when @a <= 4 then "UCL" when @a = 5 then "UEL" when @a >= 18 then "EFL" else "" end as Status, Name, Win + Draw + Lose Round, Win W, Draw D, Lose L, GoalsFor GF, GoalsAgainst GA, GoalDifferent GD, Point P from EplTable2 order by Point desc, GoalDifferent desc, GoalsFor desc;drop table EplTable2;

-- 22. Giả sử kết quả vòng đấu thứ 39 là kết quả của vòng đấu số 18, tạo bảng EplTable2 giống bảng EplTable và cập nhật bảng xếp hạng.

create table EplTable2 as select * from EplTable;alter table EplTable2 add column (PreviousRank integer, CurrentRank integer);set @a=0;update EplTable2 set PreviousRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc; 
delimiter // 
for i in 0..9 do 
update EplTable2 set Win = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) > (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) = (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) < (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1), GoalsAgainst = GoalsAgainst + (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) > (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Point + 3 when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) = (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Point + 1 else Point end where ShortName = (select Home from Result where(Round = 18) order by Home asc, Away asc limit i,1);
update EplTable2 set Win = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) < (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) = (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) > (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1), GoalsAgainst = GoalsAgainst + (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) < (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Point + 3 when (select HomeScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) = (select AwayScore from Result where(Round = 18) order by Home asc, Away asc limit i,1) then Point + 1 else Point end where ShortName = (select Away from Result where(Round = 18) order by Home asc, Away asc limit i,1);end for; 
// 
delimiter ; 
set @a = 0;update EplTable2 set CurrentRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;set @a=0;select case when PreviousRank = CurrentRank then concat((@a := @a+1), ' ', '-') when PreviousRank > CurrentRank then concat((@a := @a+1), ' ', '^') else concat((@a := @a+1), ' ', 'v') end as 'Rank', case when @a <= 4 then "UCL" when @a = 5 then "UEL" when @a >= 18 then "EFL" else "" end as Status, Name, Win + Draw + Lose Round, Win W, Draw D, Lose L, GoalsFor GF, GoalsAgainst GA, GoalDifferent GD, Point P from EplTable2 order by Point desc, GoalDifferent desc, GoalsFor desc;drop table EplTable2;

-- 23. Đưa ra 10 cầu thủ được ra sân nhiều nhất.

select EplTable.Name 'Team', concat(Players.LastName, ' ', Players.FirstName) 'Name', Players.Minutes from EplTable, Players where(EplTable.ShortName = Players.ShortName) order by Players.Minutes desc limit 10;

-- 24. Đưa ra 10 cầu thủ được vào sân từ ghế dự bị nhiều nhất.

select EplTable.Name 'Team', concat(Players.LastName, ' ', Players.FirstName) 'Name', Players.Games - Players.GameStarted 'Games' from EplTable, Players where(EplTable.ShortName = Players.ShortName) order by Players.Games - Players.GameStarted desc limit 10;

-- 25. Đưa ra 10 cầu thủ có hiệu suất ghi bàn tốt nhất.

select EplTable.Name 'Team', concat(Players.LastName, ' ', Players.FirstName) 'Name', round(Players.Shots / Players.Goals, 2) 'Shots/Goals' from EplTable, Players where(EplTable.ShortName = Players.ShortName and Players.Goals > 0 and Players.Shots > 0) order by round(Players.Shots / Players.Goals, 2) asc limit 10;

-- 26. Chọn ngẫu nhiên một vòng đấu (từ 1 đến 38, 10 trận 1 vòng) và chọn ngẫu nhiên tỉ số của 10 trận đấu đó, hiển thị kết quả 10 trận đấu và cập nhật bảng xếp hạng.

create table EplTable2 as select * from EplTable;alter table EplTable2 add column (PreviousRank integer, CurrentRank integer);set @a=0;set @round = floor(1+38*rand());update EplTable2 set PreviousRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;create table Round39(Home varchar(3), Away varchar(3), HomeScore integer, AwayScore integer, constraint primary key(Home, Away));
delimiter // 
for i in 0..9 do insert into Round39 values((select Home from Result where(Round = @round) order by Home asc, Away asc limit i,1), (select Away from Result where(Round = @round) order by Home asc, Away asc limit i,1), floor(6*rand()), floor(6*rand()));end for;
// 
for i in 0..9 do 
update EplTable2 set Win = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) > (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) = (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) < (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select HomeScore from Round39 order by Home asc, Away asc limit i,1), GoalsAgainst = GoalsAgainst + (select AwayScore from Round39 order by Home asc, Away asc limit i,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) > (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Point + 3 when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) = (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Point + 1 else Point end where ShortName = (select Home from Round39 order by Home asc, Away asc limit i,1);
update EplTable2 set Win = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) < (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) = (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) > (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select AwayScore from Round39 order by Home asc, Away asc limit i,1), GoalsAgainst = GoalsAgainst + (select HomeScore from Round39 order by Home asc, Away asc limit i,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) < (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Point + 3 when (select HomeScore from Round39 order by Home asc, Away asc limit i,1) = (select AwayScore from Round39 order by Home asc, Away asc limit i,1) then Point + 1 else Point end where ShortName = (select Away from Round39 order by Home asc, Away asc limit i,1);end for; 
// 
delimiter ; 
set @a = 0;update EplTable2 set CurrentRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;set @a=0;select concat(a.Name, ' ', Round39.HomeScore, '-', Round39.AwayScore, ' ', b.Name) 'Match', ClubInfo.StadiumName, StadiumInfo.Seats from EplTable as a, EplTable as b, Round39, ClubInfo, StadiumInfo where(a.ShortName = Round39.Home and b.ShortName = Round39.Away and a.ShortName = ClubInfo.ShortName and ClubInfo.StadiumName = StadiumInfo.StadiumName);select case when PreviousRank = CurrentRank then concat((@a := @a+1), ' ', '-') when PreviousRank > CurrentRank then concat((@a := @a+1), ' ', '^') else concat((@a := @a+1), ' ', 'v') end as 'Rank', case when @a <= 4 then "UCL" when @a = 5 then "UEL" when @a >= 18 then "EFL" else "" end as Status, Name, Win + Draw + Lose Round, Win W, Draw D, Lose L, GoalsFor GF, GoalsAgainst GA, GoalDifferent GD, Point P from EplTable2 order by Point desc, GoalDifferent desc, GoalsFor desc;drop table EplTable2, Round39;

-- 27. Chọn ngẫu nhiên 2 đội bóng, in ra đội hình xuất phát, lịch sử đối đầu và tỉ số trận đấu giữa 2 đội, cập nhật bảng xếp hạng.

create table EplTable2 as select * from EplTable;alter table EplTable2 add column (PreviousRank integer, CurrentRank integer);set @a=0;
delimiter //
set @home=floor(19 * rand()),@away=floor(19 * rand()),@gh=floor(6*rand()),@ga=floor(6*rand()),@homename='',@awayname='';while @home=@away do set @home=floor(19 * rand()),@away=floor(19 * rand());end while;
// 
delimiter ;
update EplTable2 set PreviousRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;
delimiter //
for i in 0..19 do 
if i = @home then set @homename=(select Name from EplTable limit i,1);update EplTable2 set Win = case when @gh > @ga then Win + 1 else Win end, Draw = case when @gh=@ga then Draw + 1 else Draw end, Lose = case when @gh<@ga then Lose + 1 else Lose end, GoalsFor = GoalsFor + @gh, GoalsAgainst = GoalsAgainst + @ga, GoalDifferent = GoalsFor - GoalsAgainst, Point = case when @gh>@ga then Point + 3 when @gh=@ga then Point + 1 else Point end where Name = (select Name from EplTable limit i,1);(select concat(Name, ' ', 'starting lineup') '' from EplTable where Name = (select Name from EplTable limit i,1))union(select concat(LastName, ' ', FirstName) 'Name' from Players where(ShortName = (select ShortName from EplTable limit i,1)) order by Minutes desc limit 11);end if;
if i = @away then set @awayname=(select Name from EplTable limit i,1);update EplTable2 set Win = case when @gh < @ga then Win + 1 else Win end, Draw = case when @gh=@ga then Draw + 1 else Draw end, Lose = case when @gh>@ga then Lose + 1 else Lose end, GoalsFor = GoalsFor + @ga, GoalsAgainst = GoalsAgainst + @gh, GoalDifferent = GoalsFor - GoalsAgainst, Point = case when @gh<@ga then Point + 3 when @gh=@ga then Point + 1 else Point end where Name = (select Name from EplTable limit i,1);(select concat(Name, ' ', 'starting lineup') '' from EplTable where Name = (select Name from EplTable limit i,1))union(select concat(LastName, ' ', FirstName) 'Name' from Players where(ShortName = (select ShortName from EplTable limit i,1)) order by Minutes desc limit 11);end if; 
end for; 
// 
delimiter ;
select Result.Round, concat(a.Name, ' ', Result.HomeScore, '-', Result.AwayScore, ' ', b.Name) 'History', ClubInfo.StadiumName, StadiumInfo.Seats from EplTable as a, EplTable as b, Result, ClubInfo, StadiumInfo where(a.ShortName = Result.Home and b.ShortName = Result.Away and a.ShortName = ClubInfo.ShortName and ClubInfo.StadiumName = StadiumInfo.StadiumName and ((a.Name = @homename and b.Name = @awayname) or (b.Name = @homename and a.Name = @awayname))) order by Result.Round;select concat(@homename, ' ', @gh, ' - ', @ga, ' ', @awayname) 'Match';
set @a = 0;update EplTable2 set CurrentRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;set @a=0;select case when PreviousRank = CurrentRank then concat((@a := @a+1), ' ', '-') when PreviousRank > CurrentRank then concat((@a := @a+1), ' ', '^') else concat((@a := @a+1), ' ', 'v') end as 'Rank', case when @a <= 4 then "UCL" when @a = 5 then "UEL" when @a >= 18 then "EFL" else "" end as Status, Name, Win + Draw + Lose Round, Win W, Draw D, Lose L, GoalsFor GF, GoalsAgainst GA, GoalDifferent GD, Point P from EplTable2 order by Point desc, GoalDifferent desc, GoalsFor desc;drop table EplTable2;

-- 28. Đưa ra cặp đấu có tổng tỉ số lượt đi và lượt về lớn nhất.

select concat(a.Name, ' ', c.HomeScore + d.AwayScore, ' - ', c.AwayScore + d.HomeScore, ' ', b.Name) 'Match' from EplTable as a, EplTable as b, Result as c, Result as d where(a.ShortName = c.Home and b.ShortName = c.Away and c.Round <= 19 and a.ShortName = d.Away and b.ShortName = d.Home and d.Round >= 20 and c.HomeScore + c.AwayScore + d.HomeScore + d.AwayScore = (select max(c.HomeScore + c.AwayScore + d.HomeScore + d.AwayScore) from Result as c, Result as d where(c.Home = d.Away and c.Away = d.Home)));

-- 29. Thiết lập lịch thi đấu vòng 39, giả lập kết quả và cập nhật bảng xếp hạng.

create table EplTable2 as select * from EplTable;alter table EplTable2 add column (PreviousRank integer, CurrentRank integer, Num float, Score integer);set @a=0;update EplTable2 set PreviousRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;create table Round39(Id integer primary key auto_increment, Home varchar(30), Away varchar(30), HomeScore integer, AwayScore integer);
delimiter // 
for i in 0..19 do update EplTable2 set Num = rand(), Score = floor(6 * rand()) where ShortName = (select ShortName from EplTable limit i,1);end for;
// 
for i in 0..19 do 
if i%2=0 then insert into Round39(Home, HomeScore) values((select Name from EplTable2 order by Num limit i,1), (select Score from EplTable2 order by Num limit i,1));end if;
if i%2=1 then update Round39 set Away = (select Name from EplTable2 order by Num limit i,1), AwayScore = (select Score from EplTable2 order by Num limit i,1) where(Home = (select Home from Round39 order by Id desc limit 1));end if;
end for;
// 
for i in 0..9 do update EplTable2 set Win = case when (select HomeScore from Round39 order by Id limit i,1) > (select AwayScore from Round39 order by Id limit i,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Round39 order by Id limit i,1) = (select AwayScore from Round39 order by Id limit i,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Round39 order by Id limit i,1) < (select AwayScore from Round39 order by Id limit i,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select HomeScore from Round39 order by Id limit i,1), GoalsAgainst = GoalsAgainst + (select AwayScore from Round39 order by Id limit i,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Round39 order by Id limit i,1) > (select AwayScore from Round39 order by Id limit i,1) then Point + 3 when (select HomeScore from Round39 order by Id limit i,1) = (select AwayScore from Round39 order by Id limit i,1) then Point + 1 else Point end where Name = (select Home from Round39 order by Id limit i,1);end for; 
// 
for i in 0..9 do update EplTable2 set Win = case when (select HomeScore from Round39 order by Id limit i,1) < (select AwayScore from Round39 order by Id limit i,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Round39 order by Id limit i,1) = (select AwayScore from Round39 order by Id limit i,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Round39 order by Id limit i,1) > (select AwayScore from Round39 order by Id limit i,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select AwayScore from Round39 order by Id limit i,1), GoalsAgainst = GoalsAgainst + (select HomeScore from Round39 order by Id limit i,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Round39 order by Id limit i,1) < (select AwayScore from Round39 order by Id limit i,1) then Point + 3 when (select HomeScore from Round39 order by Id limit i,1) = (select AwayScore from Round39 order by Id limit i,1) then Point + 1 else Point end where Name = (select Away from Round39 order by Id limit i,1);end for; 
// 
delimiter ; 
set @a = 0;update EplTable2 set CurrentRank = (@a:= @a+1) order by EplTable2.Point desc, GoalDifferent desc, GoalsFor desc;set @a=0;select concat(a.Name, ' ', Round39.HomeScore, '-', Round39.AwayScore, ' ', b.Name) 'Match', ClubInfo.StadiumName, StadiumInfo.Seats from EplTable as a, EplTable as b, Round39, ClubInfo, StadiumInfo where(a.ShortName = Round39.Home and b.ShortName = Round39.Away and a.ShortName = ClubInfo.ShortName and ClubInfo.StadiumName = StadiumInfo.StadiumName);select concat(Home, ' ', HomeScore, ' - ', AwayScore, ' ', Away) 'Result' from Round39;select case when PreviousRank = CurrentRank then concat((@a := @a+1), ' ', '-') when PreviousRank > CurrentRank then concat((@a := @a+1), ' ', '^') else concat((@a := @a+1), ' ', 'v') end as 'Rank', case when @a <= 4 then "UCL" when @a = 5 then "UEL" when @a >= 18 then "EFL" else "" end as Status, Name, Win + Draw + Lose Round, Win W, Draw D, Lose L, GoalsFor GF, GoalsAgainst GA, GoalDifferent GD, Point P from EplTable2 order by Point desc, GoalDifferent desc, GoalsFor desc;drop table EplTable2, Round39;

-- 30. Thiết lập lịch thi đấu cho 20 đội ở mùa tiếp theo (38 vòng đấu).

create table EplTable2 as select * from EplTable;alter table EplTable2 add column (Num float, Rank integer);create table Fixtures(Round integer, Home varchar(30), Away varchar(30));
delimiter // 
for i in 0..19 do update EplTable2 set Num = rand() where ShortName = (select ShortName from EplTable limit i,1);end for;
// 
delimiter ;
set @a=0;update EplTable2 set Rank = (@a:=@a+1) order by EplTable2.Num;
delimiter //
for i in 1..19 do set @c=round(rand());if @c = 0 then insert into Fixtures values(i, (select Name from EplTable2 where(Rank = i)), (select Name from EplTable2 where(Rank = 20)));else insert into Fixtures values(i, (select Name from EplTable2 where(Rank = 20)), (select Name from EplTable2 where(Rank = i)));end if;
for j in 1..9 do 
if i-j<=0 then set @a=19-j+i;else set @a=i-j;end if;
if i+j>19 then set @b=i+j-19;else set @b=i+j;end if;
set@c=round(rand());if @c = 0 then insert into Fixtures values(i, (select Name from EplTable2 where(Rank = @a)), (select Name from EplTable2 where(Rank = @b)));else insert into Fixtures values(i, (select Name from EplTable2 where(Rank = @b)), (select Name from EplTable2 where(Rank = @a)));end if;
end for;
end for;
// 
delimiter ;
delimiter // 
for i in 0..19 do update EplTable2 set Num = rand() where ShortName = (select ShortName from EplTable limit i,1);end for;
// 
delimiter ;
set @a=0;update EplTable2 set Rank = (@a:=@a+1) order by EplTable2.Num;
delimiter //
for i in 1..19 do 
insert into Fixtures(Round, Home, Away) select i+19, (select Name from EplTable2 where(Rank = i)), (select Name from EplTable2 where(Rank = 20)) where not exists (select Home, Away from Fixtures where(Fixtures.Home = (select Name from EplTable2 where(Rank = i)) and Fixtures.Away = (select Name from EplTable2 where(Rank = 20)))) limit 1;
insert into Fixtures(Round, Home, Away) select i+19, (select Name from EplTable2 where(Rank = 20)), (select Name from EplTable2 where(Rank = i)) where not exists (select Home, Away from Fixtures where(Fixtures.Home = (select Name from EplTable2 where(Rank = 20)) and Fixtures.Away = (select Name from EplTable2 where(Rank = i)))) limit 1;
for j in 1..9 do 
if i-j<=0 then set @a=19-j+i;else set @a=i-j;end if;
if i+j>19 then set @b=i+j-19;else set @b=i+j;end if;
insert into Fixtures(Round, Home, Away) select i+19, (select Name from EplTable2 where(Rank = @a)), (select Name from EplTable2 where(Rank = @b)) where not exists (select Home, Away from Fixtures where(Fixtures.Home = (select Name from EplTable2 where(Rank = @a)) and Fixtures.Away = (select Name from EplTable2 where(Rank = @b)))) limit 1;
insert into Fixtures(Round, Home, Away) select i+19, (select Name from EplTable2 where(Rank = @b)), (select Name from EplTable2 where(Rank = @a)) where not exists (select Home, Away from Fixtures where(Fixtures.Home = (select Name from EplTable2 where(Rank = @b)) and Fixtures.Away = (select Name from EplTable2 where(Rank = @a)))) limit 1;
end for;
end for;
// 
delimiter ;
select * from Fixtures;drop table EplTable2, Fixtures;

-- 31. Đưa ra tổng số bàn thắng của mỗi đội bóng từ vòng 16 đến 25.

create table EplTable2 as select * from EplTable;alter table EplTable2 add column (Id integer, SumOfGoals integer default 0);
delimiter //
for i in 16..25 do
for j in 0..9 do
update EplTable2 set SumOfGoals = SumOfGoals + (select HomeScore from Result where (Round = i) order by Home, Away limit j,1) where (ShortName = (select Home from Result where (Round = i) order by Home, Away limit j,1));
update EplTable2 set SumOfGoals = SumOfGoals + (select AwayScore from Result where (Round = i) order by Home, Away limit j,1) where (ShortName = (select Away from Result where (Round = i) order by Home, Away limit j,1));
end for;
end for;
//
delimiter ;
select Name, SumOfGoals from EplTable2 order by SumOfGoals desc;drop table EplTable2;

-- 32. Đưa ra bảng xếp hạng Ngoại hạng Anh sau vòng 23.

create table EplTable2 like EplTable;
delimiter //
for i in 0..19 do
insert into EplTable2 values((select Name from EplTable limit i,1), (select ShortName from EplTable limit i,1),0,0,0,0,0,0,0);
end for;
for i in 1..23 do
for j in 0..9 do 
update EplTable2 set Win = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) > (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) = (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) < (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1), GoalsAgainst = GoalsAgainst + (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) > (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Point + 3 when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) = (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Point + 1 else Point end where ShortName = (select Home from Result where (Round = i) order by Home asc, Away asc limit j,1);
update EplTable2 set Win = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) < (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Win + 1 else Win end, Draw = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) = (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Draw + 1 else Draw end, Lose = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) > (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Lose + 1 else Lose end, GoalsFor = GoalsFor + (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1), GoalsAgainst = GoalsAgainst + (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1), GoalDifferent = GoalsFor - GoalsAgainst, Point = case when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) < (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Point + 3 when (select HomeScore from Result where (Round = i) order by Home asc, Away asc limit j,1) = (select AwayScore from Result where (Round = i) order by Home asc, Away asc limit j,1) then Point + 1 else Point end where ShortName = (select Away from Result where (Round = i) order by Home asc, Away asc limit j,1);
end for;
end for;
//
delimiter ;
set @a=0;select (@a:=@a+1) 'Rank', case when @a <= 4 then "UCL" when @a = 5 then "UEL" when @a >= 18 then "EFL" else "" end as Status, Name, Win + Draw + Lose Round, Win W, Draw D, Lose L, GoalsFor GF, GoalsAgainst GA, GoalDifferent GD, Point P from EplTable2 order by Point desc, GoalDifferent desc, GoalsFor desc;drop table EplTable2;

-- 33. Tạo game Minesweeper.

create table Minesweeper(Row integer primary key auto_increment, col1 integer default -1, col2 integer default -1, col3 integer default -1, col4 integer default -1, col5 integer default -1, col6 integer default -1, col7 integer default -1, col8 integer default -1, col9 integer default -1, col10 integer default -1, col11 integer default -1, col12 integer default -1, col13 integer default -1, col14 integer default -1, col15 integer default -1, col16 integer default -1, col17 integer default -1, col18 integer default -1, col19 integer default -1, col20 integer default -1, col21 integer default -1, col22 integer default -1, col23 integer default -1, col24 integer default -1, col25 integer default -1, col26 integer default -1, col27 integer default -1, col28 integer default -1, col29 integer default -1, col30 integer default -1);
create table Minesweeper2(Row integer primary key auto_increment, col1 varchar(1) default '', col2 varchar(1) default '', col3 varchar(1) default '', col4 varchar(1) default '', col5 varchar(1) default '', col6 varchar(1) default '', col7 varchar(1) default '', col8 varchar(1) default '', col9 varchar(1) default '', col10 varchar(1) default '', col11 varchar(1) default '', col12 varchar(1) default '', col13 varchar(1) default '', col14 varchar(1) default '', col15 varchar(1) default '', col16 varchar(1) default '', col17 varchar(1) default '', col18 varchar(1) default '', col19 varchar(1) default '', col20 varchar(1) default '', col21 varchar(1) default '', col22 varchar(1) default '', col23 varchar(1) default '', col24 varchar(1) default '', col25 varchar(1) default '', col26 varchar(1) default '', col27 varchar(1) default '', col28 varchar(1) default '', col29 varchar(1) default '', col30 varchar(1) default '');
delimiter //
for i in 1..16 do
insert into Minesweeper() values();
insert into Minesweeper2() values();
end for;
//
delimiter ;
create table Bombs(Rank integer, Number float, Id integer primary key auto_increment);
delimiter //
for i in 1..480 do
insert into Bombs(Number) values(rand());
end for;
//
delimiter ;
set @a=0;
update Bombs set Rank = (@a:=@a+1) order by Number;
delimiter //
for i in 0..15 do
update Minesweeper set 
col1 = case when (select Rank from Bombs where Id = 1+30*i) <= 99 then -1 else null end,
col2 = case when (select Rank from Bombs where Id = 2+30*i) <= 99 then -1 else null end,
col3 = case when (select Rank from Bombs where Id = 3+30*i) <= 99 then -1 else null end,
col4 = case when (select Rank from Bombs where Id = 4+30*i) <= 99 then -1 else null end,
col5 = case when (select Rank from Bombs where Id = 5+30*i) <= 99 then -1 else null end,
col6 = case when (select Rank from Bombs where Id = 6+30*i) <= 99 then -1 else null end,
col7 = case when (select Rank from Bombs where Id = 7+30*i) <= 99 then -1 else null end,
col8 = case when (select Rank from Bombs where Id = 8+30*i) <= 99 then -1 else null end,
col9 = case when (select Rank from Bombs where Id = 9+30*i) <= 99 then -1 else null end,
col10 = case when (select Rank from Bombs where Id = 10+30*i) <= 99 then -1 else null end,
col11 = case when (select Rank from Bombs where Id = 11+30*i) <= 99 then -1 else null end,
col12 = case when (select Rank from Bombs where Id = 12+30*i) <= 99 then -1 else null end,
col13 = case when (select Rank from Bombs where Id = 13+30*i) <= 99 then -1 else null end,
col14 = case when (select Rank from Bombs where Id = 14+30*i) <= 99 then -1 else null end,
col15 = case when (select Rank from Bombs where Id = 15+30*i) <= 99 then -1 else null end,
col16 = case when (select Rank from Bombs where Id = 16+30*i) <= 99 then -1 else null end,
col17 = case when (select Rank from Bombs where Id = 17+30*i) <= 99 then -1 else null end,
col18 = case when (select Rank from Bombs where Id = 18+30*i) <= 99 then -1 else null end,
col19 = case when (select Rank from Bombs where Id = 19+30*i) <= 99 then -1 else null end,
col20 = case when (select Rank from Bombs where Id = 20+30*i) <= 99 then -1 else null end,
col21 = case when (select Rank from Bombs where Id = 21+30*i) <= 99 then -1 else null end,
col22 = case when (select Rank from Bombs where Id = 22+30*i) <= 99 then -1 else null end,
col23 = case when (select Rank from Bombs where Id = 23+30*i) <= 99 then -1 else null end,
col24 = case when (select Rank from Bombs where Id = 24+30*i) <= 99 then -1 else null end,
col25 = case when (select Rank from Bombs where Id = 25+30*i) <= 99 then -1 else null end,
col26 = case when (select Rank from Bombs where Id = 26+30*i) <= 99 then -1 else null end,
col27 = case when (select Rank from Bombs where Id = 27+30*i) <= 99 then -1 else null end,
col28 = case when (select Rank from Bombs where Id = 28+30*i) <= 99 then -1 else null end,
col29 = case when (select Rank from Bombs where Id = 29+30*i) <= 99 then -1 else null end,
col30 = case when (select Rank from Bombs where Id = 30+30*i) <= 99 then -1 else null end
where Row = i;
end for;
for i in 0..15 do
update Minesweeper set
col1 = case when (select col1 from Minesweeper where Row = i) = -1 then -1 else case when (select col1 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col2 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col2 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col2 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col1 from Minesweeper where Row = i+1) = -1 then 1 else 0 end end,
col2 = case when (select col2 from Minesweeper where Row = i) = -1 then -1 else case when (select col2 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col3 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col3 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col3 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col2 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col1 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col1 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col1 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col3 = case when (select col3 from Minesweeper where Row = i) = -1 then -1 else case when (select col3 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col4 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col4 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col4 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col3 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col2 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col2 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col2 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col4 = case when (select col4 from Minesweeper where Row = i) = -1 then -1 else case when (select col4 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col5 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col5 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col5 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col4 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col3 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col3 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col3 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col5 = case when (select col5 from Minesweeper where Row = i) = -1 then -1 else case when (select col5 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col6 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col6 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col6 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col5 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col4 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col4 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col4 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col6 = case when (select col6 from Minesweeper where Row = i) = -1 then -1 else case when (select col6 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col7 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col7 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col7 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col6 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col5 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col5 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col5 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col7 = case when (select col7 from Minesweeper where Row = i) = -1 then -1 else case when (select col7 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col8 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col8 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col8 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col7 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col6 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col6 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col6 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col8 = case when (select col8 from Minesweeper where Row = i) = -1 then -1 else case when (select col8 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col9 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col9 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col9 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col8 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col7 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col7 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col7 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col9 = case when (select col9 from Minesweeper where Row = i) = -1 then -1 else case when (select col9 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col10 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col10 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col10 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col9 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col8 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col8 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col8 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col10 = case when (select col10 from Minesweeper where Row = i) = -1 then -1 else case when (select col10 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col11 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col11 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col11 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col10 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col9 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col9 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col9 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col11 = case when (select col11 from Minesweeper where Row = i) = -1 then -1 else case when (select col11 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col12 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col12 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col12 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col11 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col10 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col10 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col10 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col12 = case when (select col12 from Minesweeper where Row = i) = -1 then -1 else case when (select col12 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col13 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col13 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col13 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col12 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col11 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col11 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col11 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col13 = case when (select col13 from Minesweeper where Row = i) = -1 then -1 else case when (select col13 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col14 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col14 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col14 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col13 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col12 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col12 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col12 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col14 = case when (select col14 from Minesweeper where Row = i) = -1 then -1 else case when (select col14 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col15 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col15 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col15 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col14 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col13 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col13 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col13 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col15 = case when (select col15 from Minesweeper where Row = i) = -1 then -1 else case when (select col15 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col16 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col16 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col16 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col15 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col14 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col14 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col14 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col16 = case when (select col16 from Minesweeper where Row = i) = -1 then -1 else case when (select col16 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col17 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col17 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col17 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col16 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col15 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col15 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col15 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col17 = case when (select col17 from Minesweeper where Row = i) = -1 then -1 else case when (select col17 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col18 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col18 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col18 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col17 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col16 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col16 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col16 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col18 = case when (select col18 from Minesweeper where Row = i) = -1 then -1 else case when (select col18 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col19 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col19 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col19 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col18 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col17 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col17 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col17 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col19 = case when (select col19 from Minesweeper where Row = i) = -1 then -1 else case when (select col19 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col20 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col20 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col20 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col19 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col18 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col18 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col18 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col20 = case when (select col20 from Minesweeper where Row = i) = -1 then -1 else case when (select col20 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col21 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col21 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col21 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col20 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col19 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col19 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col19 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col21 = case when (select col21 from Minesweeper where Row = i) = -1 then -1 else case when (select col21 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col22 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col22 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col22 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col21 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col20 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col20 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col20 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col22 = case when (select col22 from Minesweeper where Row = i) = -1 then -1 else case when (select col22 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col23 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col23 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col23 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col22 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col21 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col21 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col21 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col23 = case when (select col23 from Minesweeper where Row = i) = -1 then -1 else case when (select col23 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col24 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col24 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col24 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col23 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col22 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col22 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col22 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col24 = case when (select col24 from Minesweeper where Row = i) = -1 then -1 else case when (select col24 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col25 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col25 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col25 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col24 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col23 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col23 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col23 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col25 = case when (select col25 from Minesweeper where Row = i) = -1 then -1 else case when (select col25 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col26 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col26 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col26 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col25 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col24 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col24 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col24 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col26 = case when (select col26 from Minesweeper where Row = i) = -1 then -1 else case when (select col26 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col27 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col27 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col27 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col26 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col25 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col25 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col25 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col27 = case when (select col27 from Minesweeper where Row = i) = -1 then -1 else case when (select col27 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col28 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col28 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col28 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col27 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col26 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col26 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col26 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col28 = case when (select col28 from Minesweeper where Row = i) = -1 then -1 else case when (select col28 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col29 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col29 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col29 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col28 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col27 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col27 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col27 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col29 = case when (select col29 from Minesweeper where Row = i) = -1 then -1 else case when (select col29 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col30 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col30 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col30 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col29 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col28 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col28 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col28 from Minesweeper where Row = i-1) = -1 then 1 else 0 end end,
col30 = case when (select col30 from Minesweeper where Row = i) = -1 then -1 else case when (select col30 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col29 from Minesweeper where Row = i-1) = -1 then 1 else 0 end + case when (select col29 from Minesweeper where Row = i) = -1 then 1 else 0 end + case when (select col29 from Minesweeper where Row = i+1) = -1 then 1 else 0 end + case when (select col30 from Minesweeper where Row = i+1) = -1 then 1 else 0 end end 
where Row = i;
end for;
//
delimiter ;
drop table Bombs;select * from Minesweeper2;
set @a=5;update Minesweeper2 set col5 = case when (select col5 from Minesweeper where Row = @a) = -1 then 'B' else cast((select col5 from Minesweeper where Row = @a) as varchar(1)) end where Row = @a;select * from Minesweeper2;
set @a=5;update Minesweeper2 set col5 = 'F' where Row = @a;select * from Minesweeper2;
